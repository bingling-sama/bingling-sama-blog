{"remainingRequest":"E:\\bingling-sama-blog\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\bingling-sama-blog\\node_modules\\vuepress-theme-modern-blog\\src\\components\\SearchBox.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\bingling-sama-blog\\node_modules\\vuepress-theme-modern-blog\\src\\components\\SearchBox.vue","mtime":1609037243858},{"path":"E:\\bingling-sama-blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1608470252416},{"path":"E:\\bingling-sama-blog\\node_modules\\babel-loader\\lib\\index.js","mtime":1608905603205},{"path":"E:\\bingling-sama-blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1608470252416},{"path":"E:\\bingling-sama-blog\\node_modules\\vue-loader\\lib\\index.js","mtime":1608905605904}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBGbGV4c2VhcmNoIGZyb20gJ2ZsZXhzZWFyY2gnCgpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSAoKSB7CiAgICByZXR1cm4gewogICAgICBpbmRleDogbnVsbCwKICAgICAgcXVlcnk6ICcnLAogICAgfQogIH0sCiAgbW91bnRlZCAoKSB7CiAgICB0aGlzLmluZGV4ID0gbmV3IEZsZXhzZWFyY2goewogICAgICB0b2tlbml6ZTogJ2ZvcndhcmQnLAogICAgICBkb2M6IHsKICAgICAgICBpZDogJ2tleScsCiAgICAgICAgZmllbGQ6IFsndGl0bGUnLCAnY29udGVudCddLAogICAgICB9LAogICAgfSkKICAgIGNvbnN0IHsgcGFnZXMgfSA9IHRoaXMuJHNpdGUKICAgIHRoaXMuaW5kZXguYWRkKHBhZ2VzKQogIH0sCiAgbWV0aG9kczogewogICAgcXVlcnlTZWFyY2hBc3luYyAocXVlcnlTdHJpbmcsIGNiKSB7CiAgICAgIGNvbnN0IHsgdGhlbWVDb25maWcgfSA9IHRoaXMuJHNpdGUKICAgICAgY29uc3QgcXVlcnkgPSBxdWVyeVN0cmluZy50cmltKCkudG9Mb3dlckNhc2UoKQogICAgICBjb25zdCB1c2luZ0dvb2dsZVNlYXJjaCA9CiAgICAgICAgdGhlbWVDb25maWcuZ29vZ2xlQ3VzdG9tU2VhcmNoRW5naW5lSUQgJiYgdGhlbWVDb25maWcuZ29vZ2xlQVBJS2V5CiAgICAgIGNvbnN0IG1heCA9IHRoZW1lQ29uZmlnLnNlYXJjaE1heFN1Z2dlc3Rpb25zIHx8IDIwCiAgICAgIGlmICh0aGlzLmluZGV4ID09PSBudWxsIHx8IHF1ZXJ5Lmxlbmd0aCA8IDEpIHsKICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUKICAgICAgICByZXR1cm4gY2IoW10pCiAgICAgIH0KICAgICAgdGhpcy5pbmRleC5zZWFyY2goCiAgICAgICAgcXVlcnksCiAgICAgICAgewogICAgICAgICAgbGltaXQ6IG1heCwKICAgICAgICAgIHRocmVzaG9sZDogNCwKICAgICAgICAgIGVuY29kZTogJ2V4dHJhJywKICAgICAgICB9LAogICAgICAgIHJlc3VsdCA9PiB7CiAgICAgICAgICBpZiAocmVzdWx0Lmxlbmd0aCkgewogICAgICAgICAgICBjb25zdCByZXNvbHZlZFJlc3VsdCA9IHJlc3VsdC5tYXAocGFnZSA9PiB7CiAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIGxpbms6IHBhZ2UucGF0aCwKICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLmdldFF1ZXJ5U25pcHBldChwYWdlKSwKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIHJldHVybiBjYihyZXNvbHZlZFJlc3VsdCkKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmICh1c2luZ0dvb2dsZVNlYXJjaCkgewogICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZQogICAgICAgICAgICAgIHJldHVybiBjYihbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLiR0KCdzZWFyY2hfZW50aXJlX3NpdGUnLCB7IHF1ZXJ5IH0pLAogICAgICAgICAgICAgICAgICBsaW5rOiBgL3NlYXJjaD9xPSR7cXVlcnl9YCwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgXSkKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUKICAgICAgICAgICAgICBjYihbeyB2YWx1ZTogdGhpcy4kdCgnbm9fcmVzdWx0cycpLCBsaW5rOiAnJyB9XSkKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICkKICAgIH0sCiAgICBnZXRRdWVyeVNuaXBwZXQgKHBhZ2UpIHsKICAgICAgY29uc3QgcXVlcnlQb3NpdGlvbiA9IHBhZ2UuY29udGVudC50b0xvd2VyQ2FzZSgpLmluZGV4T2YodGhpcy5xdWVyeSkKICAgICAgY29uc3Qgc3RhcnRJbmRleCA9IHF1ZXJ5UG9zaXRpb24gLSAyMCA8IDAgPyAwIDogcXVlcnlQb3NpdGlvbiAtIDIwCiAgICAgIGNvbnN0IGVuZEluZGV4ID0gcXVlcnlQb3NpdGlvbiArIDMwCiAgICAgIGNvbnN0IHF1ZXJ5U25pcHBldCA9IHBhZ2UuY29udGVudAogICAgICAgIC5zbGljZShzdGFydEluZGV4LCBlbmRJbmRleCkKICAgICAgICAudG9Mb3dlckNhc2UoKQogICAgICAgIC5yZXBsYWNlKAogICAgICAgICAgdGhpcy5xdWVyeSwKICAgICAgICAgIGA8c3Ryb25nIGNsYXNzPSJ0ZXh0LS1wcmltYXJ5Ij4ke3RoaXMucXVlcnl9PC9zdHJvbmc+YCwKICAgICAgICApCiAgICAgICAgLnNwbGl0KCcgJykKICAgICAgICAuc2xpY2UoMSwgLTEpCiAgICAgICAgLmpvaW4oJyAnKQogICAgICBpZiAocXVlcnlTbmlwcGV0KSB7CiAgICAgICAgcmV0dXJuIGAKICAgICAgICA8c3Ryb25nIGNsYXNzPSJ0ZXh0LS1wcmltYXJ5Ij4ke3BhZ2UudGl0bGV9PC9zdHJvbmc+XG4KICAgICAgICA8ZGl2IGNsYXNzPSJ0ZXh0LW11dGVkIHBsLTIiPiAke3F1ZXJ5U25pcHBldH0gLi48L2Rpdj5gCiAgICAgICAgICAucmVwbGFjZSgvXHwvZywgJyAnKQogICAgICAgICAgLnJlcGxhY2UoLzo6Oi9nLCAnICcpCiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHBhZ2UudGl0bGUKICAgICAgfQogICAgfSwKICAgIGhhbmRsZVNlbGVjdCAoaXRlbSkgewogICAgICBpZiAoaXRlbS5saW5rKSB7CiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goaXRlbS5saW5rKQogICAgICB9CiAgICAgIHRoaXMucXVlcnkgPSAnJwogICAgfSwKICB9LAp9Cg=="},{"version":3,"sources":["SearchBox.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAwBA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SearchBox.vue","sourceRoot":"node_modules/vuepress-theme-modern-blog/src/components","sourcesContent":["<template>\n  <div class=\"search-wrapper u-px3 d-flex align-items-center\">\n    <el-autocomplete\n      ref=\"searchInput\"\n      slot=\"reference\"\n      v-model=\"query\"\n      size=\"small\"\n      :fetch-suggestions=\"querySearchAsync\"\n      :placeholder=\"$t('search_placeholder')\"\n      popper-class=\"components-search\"\n      :trigger-on-focus=\"false\"\n      placement=\"bottom-end\"\n      :debounce=\"200\"\n      @select=\"handleSelect\"\n    >\n      <template slot-scope=\"props\">\n        <!-- eslint-disable-next-line -->\n        <li role=\"option\" v-html=\"props.item.value\"/>\n      </template>\n    </el-autocomplete>\n  </div>\n</template>\n\n<script>\nimport Flexsearch from 'flexsearch'\n\nexport default {\n  data () {\n    return {\n      index: null,\n      query: '',\n    }\n  },\n  mounted () {\n    this.index = new Flexsearch({\n      tokenize: 'forward',\n      doc: {\n        id: 'key',\n        field: ['title', 'content'],\n      },\n    })\n    const { pages } = this.$site\n    this.index.add(pages)\n  },\n  methods: {\n    querySearchAsync (queryString, cb) {\n      const { themeConfig } = this.$site\n      const query = queryString.trim().toLowerCase()\n      const usingGoogleSearch =\n        themeConfig.googleCustomSearchEngineID && themeConfig.googleAPIKey\n      const max = themeConfig.searchMaxSuggestions || 20\n      if (this.index === null || query.length < 1) {\n        // eslint-disable-next-line\n        return cb([])\n      }\n      this.index.search(\n        query,\n        {\n          limit: max,\n          threshold: 4,\n          encode: 'extra',\n        },\n        result => {\n          if (result.length) {\n            const resolvedResult = result.map(page => {\n              return {\n                link: page.path,\n                value: this.getQuerySnippet(page),\n              }\n            })\n            return cb(resolvedResult)\n          } else {\n            if (usingGoogleSearch) {\n              // eslint-disable-next-line\n              return cb([\n                {\n                  value: this.$t('search_entire_site', { query }),\n                  link: `/search?q=${query}`,\n                },\n              ])\n            } else {\n              // eslint-disable-next-line\n              cb([{ value: this.$t('no_results'), link: '' }])\n            }\n          }\n        },\n      )\n    },\n    getQuerySnippet (page) {\n      const queryPosition = page.content.toLowerCase().indexOf(this.query)\n      const startIndex = queryPosition - 20 < 0 ? 0 : queryPosition - 20\n      const endIndex = queryPosition + 30\n      const querySnippet = page.content\n        .slice(startIndex, endIndex)\n        .toLowerCase()\n        .replace(\n          this.query,\n          `<strong class=\"text--primary\">${this.query}</strong>`,\n        )\n        .split(' ')\n        .slice(1, -1)\n        .join(' ')\n      if (querySnippet) {\n        return `\n        <strong class=\"text--primary\">${page.title}</strong>\\n\n        <div class=\"text-muted pl-2\"> ${querySnippet} ..</div>`\n          .replace(/\\|/g, ' ')\n          .replace(/:::/g, ' ')\n      } else {\n        return page.title\n      }\n    },\n    handleSelect (item) {\n      if (item.link) {\n        this.$router.push(item.link)\n      }\n      this.query = ''\n    },\n  },\n}\n</script>\n\n<style lang=\"stylus\">\n.search-wrapper {\n  .el-input__inner {\n    height: 2rem !important;\n  }\n\n  .search-wrapper input {\n    width: 160px;\n    transition: all 0.5s ease;\n  }\n\n  .el-autocomplete-suggestion__wrap, .el-autocomplete-suggestion {\n    width: 100%;\n  }\n\n  .el-input__suffix {\n    line-height: 2rem;\n  }\n}\n\n.components-search {\n  width: 30rem !important;\n}\n\n@media only screen and (max-width: $MQMobile) {\n  .components-search {\n    width: calc(100% - 10px) !important;\n  }\n}\n</style>\n"]}]}