import re

import requests

while 1:
    song_id = input()
    file = "test/"
    wang_url = 'https://music.163.com/song?id=' + song_id
    song_url = "https://link.hhtjim.com/163/" + song_id + ".mp3"
    # 获取歌曲16进制编码
    song = requests.get(song_url).content
    # 获取歌曲名称
    song_name = re.findall('<em class="f-ff2">.*</em>', requests.get(wang_url).text)[0].lstrip('<em class="f-ff2">').rstrip('</em>')
    # 剔除非法文件名
    song_name = re.sub(r'[\\/:*?"<>|\r\n]+', "_", song_name)
    # 保存文件
    with open(file + song_name + '.mp3', 'wb') as f:
        f.write(song)
        print(song_url + ' 歌名：' + song_name)
